(this["webpackJsonpreact-apppp"]=this["webpackJsonpreact-apppp"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(21),o=n.n(s),i=(n(29),n(23)),r=n(9),l=n(3),u=n(2),p=n(0);var d=function(e){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{className:"popup popup__".concat(e.type," ").concat(e.isOpen?"popup_is_open":""),children:Object(p.jsxs)("div",{className:"popup__container",children:[Object(p.jsx)("button",{type:"button","aria-label":"close",className:"button popup__close",onClick:e.onClose}),Object(p.jsx)("h2",{className:"popup__container-title",children:e.title}),Object(p.jsxs)("form",{className:"popup__form",action:"#",onSubmit:e.onSubmit,children:[e.children,Object(p.jsx)("button",{type:"submit",value:"submit",className:"button popup__submit popup__button",children:e.buttonText})]})]})})})};var h=function(e){var t=c.a.useRef(),n=c.a.useRef();return Object(p.jsxs)(d,{title:"New place",type:"add-place",isOpen:e.isOpen,buttonText:"Save",onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onAddPlace({name:t.current.value,link:n.current.value})},children:[Object(p.jsx)("input",{ref:t,required:!0,minLength:"1",maxLength:"30",type:"text",className:"popup__input popup__input-type-title",placeholder:"Title"}),Object(p.jsx)("span",{className:"popup__error"}),Object(p.jsx)("input",{ref:n,required:!0,type:"url",className:"popup__input popup__input-type-link",placeholder:"Image link"}),Object(p.jsx)("span",{className:"popup__error"})]})},b=n(14),j=n(15),m=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(b.a)(this,e),this.baseUrl=n,this.headers=a}return Object(j.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getUserInfo",value:function(e){return fetch("".concat(this.baseUrl,"/users/me"),{method:"GET",headers:this.headers}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:n})}).then(this._checkResponse)}},{key:"getCardsList",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{method:"GET",headers:this.headers}).then(this._checkResponse)}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:n})}).then(this._checkResponse)}},{key:"removeCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then(this._checkResponse)}},{key:"addLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers}).then(this._checkResponse)}},{key:"deleteLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers}).then(this._checkResponse)}},{key:"setUserPic",value:function(e){var t=e.avatar;return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}}]),e}())({baseUrl:"dariavolyn.students.nomoreparties.site",headers:{"Content-Type":"application/json"}}),_=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(b.a)(this,e),this.baseUrl=n,this.headers=a}return Object(j.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():console.log("Error: ".concat(e.status))}},{key:"registerUser",value:function(e){var t=e.email,n=e.password;return fetch("".concat(this.baseUrl,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then(this._checkResponse)}},{key:"authorizeUser",value:function(e){var t=e.email,n=e.password;return fetch("".concat(this.baseUrl,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then(this._checkResponse).then((function(e){return e.token?(localStorage.setItem("token",e.token),e):void 0}))}},{key:"getContent",value:function(e){return fetch("".concat(this.baseUrl,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkResponse).then((function(e){return e}))}}]),e}())({baseUrl:"dariavolyn.students.nomoreparties.site"}),f=c.a.createContext();var O=function(e){var t=c.a.useRef();return Object(p.jsxs)(d,{title:"Change profile picture",type:"edit-avatar",isOpen:e.isOpen,buttonText:"Save",onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(p.jsx)("input",{ref:t,required:!0,type:"url",className:"popup__input popup__input_type-edit-avatar",placeholder:"Image link"}),Object(p.jsx)("span",{className:"popup__error",id:""})]})};var v=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),s=n[0],o=n[1],i=Object(a.useState)(""),r=Object(l.a)(i,2),u=r[0],h=r[1],b=c.a.useContext(f);return c.a.useEffect((function(){o(b.name),h(b.about)}),[b,e.isOpen]),Object(p.jsxs)(d,{title:"Edit profile",type:"edit-profile",isOpen:e.isOpen,buttonText:"Save",onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:s,about:u})},children:[Object(p.jsx)("input",{required:!0,minLength:"2",maxLength:"40",type:"text",className:"popup__input popup__input__type-edit-profile",value:s||"",onChange:function(e){o(e.target.value)}}),Object(p.jsx)("span",{className:"popup__error",id:""}),Object(p.jsx)("input",{required:!0,minLength:"2",maxLength:"200",type:"text",className:"popup__input popup__input__type-edit-profile",value:u||"",onChange:function(e){h(e.target.value)}}),Object(p.jsx)("span",{className:"popup__error",id:""})]})};var g=function(){return Object(p.jsx)("div",{className:"footer",children:Object(p.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Around The U.S."})})},x=n(8),k=n.p+"static/media/logo.4e8e0a1d.svg";var N=function(e){var t=e.loggedIn,n=Object(u.g)();return t?Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("img",{className:"logo",src:k,alt:"Around The US logo"}),Object(p.jsxs)("nav",{className:"header__nav-wrapper",children:[Object(p.jsx)("h3",{className:"header__email",children:e.userData.email}),Object(p.jsx)("button",{onClick:function(){e.onLogOut(),localStorage.removeItem("token"),n.push("/signin")},className:"button header__button",children:"Log out"})]})]}):Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("img",{className:"logo",src:k,alt:"Around The US logo"}),Object(p.jsx)("nav",{children:Object(p.jsxs)(u.d,{children:[Object(p.jsx)(u.b,{path:"/signin",children:Object(p.jsx)(x.c,{to:"/signup",className:"button header__button",children:"Sign up"})}),Object(p.jsx)(u.b,{path:"/signup",children:Object(p.jsx)(x.c,{to:"/signin",className:"button header__button",children:"Log in"})})]})})]})};var C=function(e){var t,n,a;return Object(p.jsx)("div",{className:"popup popup__image-preview ".concat(e.card&&"popup_is_open"),children:Object(p.jsx)("div",{className:"overlay",children:Object(p.jsxs)("div",{className:"popup__container popup__container_type-image-preview",children:[Object(p.jsx)("button",{"aria-label":"close",className:"button popup__close popup__close-image-preview",type:"button",onClick:e.onClose}),Object(p.jsx)("img",{className:"popup__image",src:null===(t=e.card)||void 0===t?void 0:t.link,alt:null===(n=e.card)||void 0===n?void 0:n.name}),Object(p.jsx)("h2",{className:"popup__caption",children:null===(a=e.card)||void 0===a?void 0:a.name})]})})})},y=n.p+"static/media/error.df8eddf6.svg",S=n.p+"static/media/success.1b6082f8.svg";var U=function(e){var t=e.isRegistered;return Object(p.jsx)("div",{className:"popup popup__message ".concat(e.isOpen?"popup_is_open":""),children:Object(p.jsx)("div",{className:"overlay",children:Object(p.jsxs)("div",{className:"popup__container popup__container_type-message",children:[Object(p.jsx)("button",{"aria-label":"close",className:"button popup__close popup__close-message",type:"button",onClick:e.onClose}),Object(p.jsx)("img",{className:"popup__message-image",src:t?S:y,alt:t?"Success":"Error"}),Object(p.jsx)("h2",{className:"popup__message-text",children:t?"Success! You have now been registered.":"Oops, something went wrong! Please try again."})]})})})};var T=function(e){return Object(p.jsxs)("div",{className:"auth-form",children:[Object(p.jsxs)("form",{name:"",className:"auth-form__form",action:"#",children:[Object(p.jsx)("h2",{className:"auth-form__title",children:e.title}),Object(p.jsx)("input",{name:"email",type:"email",value:e.email,onChange:e.onEmailChange,className:"auth-form__input",placeholder:"Email"}),Object(p.jsx)("input",{name:"password",type:"password",value:e.password,onChange:e.onPasswordChange,className:"auth-form__input",placeholder:"Password"}),Object(p.jsx)("button",{onClick:e.handleSubmit,className:"button auth-form__button",children:e.buttonText})]}),Object(p.jsx)("div",{className:"auth-form__footer",children:Object(p.jsx)(x.b,{to:"".concat(e.footerLink),className:"auth-form__link",children:e.footerText})})]})};var L=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(""),i=Object(l.a)(o,2),r=i[0],u=i[1];return Object(p.jsx)(T,{buttonText:"Log in",email:c,footerLink:"/signup",footerText:"Not a member yet? Sing up here!",handleSubmit:function(t){t.preventDefault(),c&&r&&e.onSubmit({email:c,password:r})},onEmailChange:function(e){s(e.target.value)},onPasswordChange:function(e){u(e.target.value)},password:r,title:"Log in"})},w=n.p+"static/media/trash.8cb59aa9.svg";var E=function(e){var t=c.a.useContext(f),n=e.card.owner._id===t._id,a="card__delete ".concat(n?"card__delete_visible":"card__delete_hidden"),s=e.card.likes.some((function(e){return e._id===t._id})),o="card__like ".concat(s?"card__like_act":"");return Object(p.jsx)("ul",{className:"places__item",children:Object(p.jsxs)("li",{className:"card",children:[Object(p.jsx)("button",{type:"button",className:"button card__delete ".concat(a),onClick:function(){e.onCardDelete(e.card)},children:Object(p.jsx)("img",{src:w,alt:"Trash icon"})}),Object(p.jsx)("div",{className:"card__image",style:{backgroundImage:"url(".concat(e.card.link,")")},onClick:function(){e.onCardClick(e.card)}}),Object(p.jsxs)("div",{className:"card__caption",children:[Object(p.jsx)("h2",{className:"card__text",children:e.card.name}),Object(p.jsxs)("div",{className:"card__like-container",children:[Object(p.jsx)("button",{type:"button",className:"button card__like ".concat(o),onClick:function(){e.onCardLike(e.card)}}),Object(p.jsx)("p",{className:"card__like-count",children:e.card.likes.length})]})]})]})})};var P=function(e){var t=c.a.useContext(f);return Object(p.jsxs)("div",{className:"main",children:[Object(p.jsxs)("div",{className:"profile",children:[Object(p.jsx)("div",{className:"profile__avatar",style:{backgroundImage:"url(".concat(t.avatar,")")},children:Object(p.jsx)("button",{type:"button",className:"button profile__avatar-edit",onClick:e.onEditAvatar})}),Object(p.jsxs)("div",{className:"profile__info",children:[Object(p.jsx)("h1",{className:"profile__name",children:t.name}),Object(p.jsx)("button",{aria__label:"edit",className:"profile__edit button",type:"button",onClick:e.onEditProfile}),Object(p.jsx)("p",{className:"profile__title",children:t.about})]}),Object(p.jsx)("button",{aria__label:"add",type:"button",className:"button profile__add",onClick:e.onAddPlace})]}),Object(p.jsx)("div",{className:"places",children:Object(p.jsx)("ul",{className:"places__list",children:e.cards.map((function(t){return Object(p.jsx)(E,{card:t,onCardClick:e.handleCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})})]})},A=n(24),R=["component"],I=function(e){var t=e.component,n=Object(A.a)(e,R);return Object(p.jsx)(u.b,{children:function(){return n.loggedIn?Object(p.jsx)(t,Object(r.a)({},n)):Object(p.jsx)(u.a,{to:"./signin"})}})};var D=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(""),i=Object(l.a)(o,2),r=i[0],u=i[1];return Object(p.jsx)(T,{buttonText:"Sign up",email:c,footerLink:"/signin",footerText:"Already a member? Log in here!",handleSubmit:function(t){t.preventDefault(),e.onSubmit({email:c,password:r})},onEmailChange:function(e){s(e.target.value)},onPasswordChange:function(e){u(e.target.value)},password:r,title:"Sign up"})};var J=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),s=n[0],o=n[1],d=Object(a.useState)([]),b=Object(l.a)(d,2),j=b[0],x=b[1],k=Object(a.useState)({}),y=Object(l.a)(k,2),S=y[0],T=y[1],w=Object(a.useState)(!1),E=Object(l.a)(w,2),A=E[0],R=E[1],J=Object(a.useState)(!1),q=Object(l.a)(J,2),F=q[0],z=q[1],B=Object(a.useState)(!1),G=Object(l.a)(B,2),H=G[0],M=G[1],Y=Object(a.useState)(null),K=Object(l.a)(Y,2),Q=K[0],V=K[1],W=Object(a.useState)(!1),X=Object(l.a)(W,2),Z=X[0],$=X[1],ee=Object(a.useState)(!1),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)({}),se=Object(l.a)(ce,2),oe=se[0],ie=se[1],re=Object(u.g)();function le(){o(!1),R(!1),z(!1),M(!1),V(null)}return c.a.useEffect((function(){m.getUserInfo().then((function(e){T(Object(r.a)(Object(r.a)({},S),{},{name:e.name,about:e.about,avatar:e.avatar,_id:e._id}))})).catch((function(e){console.log(e)}))}),[]),Object(a.useEffect)((function(){var e=localStorage.getItem("token");e&&_.getContent(e).then((function(e){$(!0),ie(e.data),re.push("/main")})).catch((function(e){return console.log(e)}))}),[]),Object(a.useEffect)((function(){m.getCardsList().then((function(e){x(e)})).catch((function(e){console.log(e)}))}),[]),Object(p.jsx)(f.Provider,{value:S,children:Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(N,{loggedIn:Z,userData:oe,onLogOut:function(){ie({}),$(!1)}}),Object(p.jsx)(C,{card:Q,onClose:le}),Object(p.jsx)(h,{isOpen:s,onClose:le,onAddPlace:function(e){m.addCard({name:e.name,link:e.link}).then((function(e){x([e].concat(Object(i.a)(j)))})).then(le).catch((function(e){console.log(e)}))}}),Object(p.jsx)(O,{isOpen:A,onClose:le,onUpdateAvatar:function(e){m.setUserPic({avatar:e.avatar}).then((function(){T(Object(r.a)(Object(r.a)({},S),{},{avatar:e.avatar}))})).then(le).catch((function(e){console.log(e)}))}}),Object(p.jsx)(v,{isOpen:F,onClose:le,onUpdateUser:function(e){m.setUserInfo({name:e.name,about:e.about}).then((function(t){T(Object(r.a)(Object(r.a)({},S),{},{name:e.name,about:e.about}))})).then(le).catch((function(e){console.log(e)}))}}),Object(p.jsx)(U,{isOpen:H,onClose:le,isRegistered:ne}),Object(p.jsxs)(u.d,{children:[Object(p.jsx)(I,{exact:!0,path:"/main",loggedIn:Z,component:P,cards:j,handleCardClick:function(e){V(e)},onAddPlace:function(){o(!0)},onCardDelete:function(e){m.removeCard(e._id).then((function(){var t=j.filter((function(t){return t._id!==e._id}));x(t)})).catch((function(e){console.log(e)}))},onCardLike:function(e){e.likes.some((function(e){return e._id===S._id}))?m.deleteLike(e._id).then((function(t){x((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)})):m.addLike(e._id).then((function(t){x((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onClose:le,onEditAvatar:function(){R(!0)},onEditProfile:function(){z(!0)}}),Object(p.jsx)(u.b,{exact:!0,path:"/signup",children:Object(p.jsx)(D,{onSubmit:function(e,t){_.registerUser(e,t).then((function(e){M(!0),e&&(ae(!0),re.push("/signin"))})).catch((function(e){console.log(e)}))}})}),Object(p.jsx)(u.b,{exact:!0,path:"/signin",children:Object(p.jsx)(L,{onSubmit:function(e,t){_.authorizeUser(e,t).then((function(t){ie(e),t.token&&($(!0),re.push("/main"))})).catch((function(e){return console.log(e)}))}})}),Object(p.jsx)(u.b,{exact:!0,path:"/",children:Z?Object(p.jsx)(u.a,{to:"/main"}):Object(p.jsx)(u.a,{to:"/signin"})})]}),Z&&Object(p.jsx)(g,{})]})})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),s(e),o(e)}))};o.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(x.a,{children:Object(p.jsx)(J,{})})}),document.getElementById("root")),q()}},[[36,1,2]]]);
//# sourceMappingURL=main.6b4dea01.chunk.js.map